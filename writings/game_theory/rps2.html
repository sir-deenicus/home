<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>[👊,📰,✂,📠] Rock,Paper,Scissors,Telephone</title>
        <style type="text/css">
            body, html
            {
                margin: 0; padding: 0; height: 100%; overflow: hidden;
            }

            #content
            {
                position:absolute; left: 0; right: 0; bottom: 0; top: 0px; 
            }
        </style>
    </head>
    <body>
        <div id="content">
            <iframe width="100%" height="100%" frameborder="0" src="http://fable.io/repl.html#?astInput=false&babili=false&evaluate=false&lineWrap=false&presets=es2015%2Creact%2Cstage-2&code=open%20System%0D%0A%0D%0Alet%20random%20%3D%20new%20Random()%20%20%0D%0A%0D%0Amodule%20Array%20%3D%0D%0A%20%20%20let%20indexed%20a%20%3D%20Array.mapi%20(fun%20i%20x%20-%3E%20(i%2Cx))%20a%0D%0A%20%20%20let%20selectColumn%20c%20a%20%3D%20%0D%0A%20%20%20%20%20%20%20Array.map%20(indexed%20%3E%3E%20Array.filter%20(fst%20%3E%3E%20(%3D)%20c)%20%3E%3E%20Array.map%20snd)%20a%20%20%0D%0A%0D%0Amodule%20String%20%3D%20%0D%0A%20%20%20let%20pad%20padlen%20(s%3Astring)%20%3D%20s%20%2B%20String.replicate%20(max%200%20(padlen%20-%20s.Length))%20%22%20%22%0D%0A%20%20%20let%20inline%20toupper%20(str%3Astring)%20%3D%20str.ToUpper()%0D%0A%20%20%20%0D%0A%0D%0Alet%20inline%20joinToStringWith%20sep%20(s%3A'a%20seq)%20%3D%20String.Join(sep%2C%20s)%0D%0A%0D%0Alet%20buildTableRow%20(collens%3A_%5B%5D)%20(row%3Astring%5B%5D)%20%3D%0D%0A%20%20%20%20%20%20%20row%20%7C%3E%20Array.mapi%20(fun%20i%20s%20-%3E%20%20String.pad%20collens.%5Bi%5D%20s)%20%7C%3E%20joinToStringWith%20%22%20%7C%20%22%0D%0A%0D%0A%0D%0Alet%20makeTable%20newline%20headers%20title%20(table%3Astring%5B%5D%5B%5D)%20%3D%0D%0A%20%20%20%20%20%20%20let%20hlen%20%3D%20Array.map%20String.length%20headers%0D%0A%0D%0A%20%20%20%20%20%20%20let%20lens%20%3D%20table%20%7C%3E%20Array.map%20(Array.map%20(String.length))%0D%0A%0D%0A%20%20%20%20%20%20%20let%20longest%20%3D%20%5B%7Cfor%20c%20in%200..headers.Length%20-%201%20-%3E%20max%20hlen.%5Bc%5D%20(Array.selectColumn%20c%20lens%20%7C%3E%20Array.map%20Seq.head%20%7C%3E%20Array.max)%7C%5D%0D%0A%0D%0A%20%20%20%20%20%20%20let%20t0%20%3D%20table%20%7C%3E%20Array.map%20(buildTableRow%20longest)%20%7C%3E%20joinToStringWith%20newline%0D%0A%0D%0A%20%20%20%20%20%20%20let%20hrow%20%3D%20%5B%7Cheaders%3B%20%5B%7Cfor%20i%20in%200..headers.Length%20-%201%20-%3E%20String.replicate%20longest.%5Bi%5D%20%22-%22%7C%5D%7C%5D%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%3E%20Array.map%20(buildTableRow%20longest)%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%3E%20joinToStringWith%20newline%0D%0A%20%20%20%20%20%20%20String.Format(%22%7B0%7D%7B1%7D%7B1%7D%7B2%7D%7B1%7D%7B3%7D%22%2C%20(String.toupper%20title)%2C%20newline%2C%20hrow%2C%20t0)%0D%0A%0D%0A%0D%0Alet%20cdf%20p%20%3D%20%0D%0A%20%20%20%20p%20%7C%3E%20Array.fold%20(fun%20(total%2C%20list)%20v%20-%3E%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20cd%20%3D%20v%20%2B%20total%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cd%2C%20cd%3A%3Alist)%20(0.%2C%20%5B%5D)%20%0D%0A%20%20%20%20%20%20%7C%3E%20snd%20%0D%0A%20%20%20%20%20%20%7C%3E%20Array.ofList%20%0D%0A%0D%0Alet%20getDiscreteSampleFromCDF%20(pcdf%3Afloat%5B%5D)%20%3D%20%0D%0A%20%20%20%20let%20k%2C%20pcdlen%20%3D%20random.NextDouble()%20*%20pcdf.%5B0%5D%2C%20pcdf.Length%20-%201%0D%0A%20%20%20%20%0D%0A%20%20%20%20let%20rec%20cummProb%20idx%20%3D%20if%20k%20%3E%20pcdf.%5Bidx%5D%20then%20cummProb%20(idx%20-%201)%20else%20idx%0D%0A%20%20%20%20%0D%0A%20%20%20%20abs(cummProb%20pcdlen%20-%20pcdlen)%20%0D%0A%0D%0Alet%20discreteSample%20p%20%3D%20cdf%20p%20%7C%3E%20getDiscreteSampleFromCDF%20%20%0D%0A%0D%0Alet%20inline%20pairop%20op%20(x%2Cy)%20(u%2Cv)%20%3D%20(op%20x%20u%2C%20op%20y%20v)%0D%0A%0D%0Alet%20round%20(n%3Aint)%20(x%3Afloat)%20%3D%20Math.Round(x%2Cn)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0Alet%20selectColumn%20c%20a%20%3D%20Array.map%20(Array.indexed%20%3E%3E%20Array.filter%20(fst%20%3E%3E%20(%3D)%20c)%20%3E%3E%20Array.map%20snd)%20a%20%0D%0A%0D%0Alet%20getStrategy%20(strategySum%3A_%5B%5D)%20regretSum%20%3D%0D%0A%20%20let%20strategy%20%20%20%20%20%20%20%20%20%3D%20Array.map%20(max%200.)%20%20regretSum%20%0D%0A%20%20let%20nSum%2C%20numactions%20%3D%20Array.sum%20strategy%2C%20strategy.Length%0D%0A%20%20%0D%0A%20%20let%20strategy'%20%3D%20%0D%0A%20%20%20%20%20%20if%20nSum%20%3C%3D%200.%20then%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20Array.create%20numactions%20(1.%2Ffloat%20numactions)%20%0D%0A%20%20%20%20%20%20else%20Array.map%20(fun%20x%20-%3E%20x%2FnSum)%20strategy%0D%0A%20%20%0D%0A%20%20for%20a%20in%200..numactions%20-%201%20do%20strategySum.%5Ba%5D%20%3C-%20strategySum.%5Ba%5D%20%2B%20strategy'.%5Ba%5D%0D%0A%20%20strategy'%0D%0A%0D%0A%0D%0Alet%20getAvgStrategy%20strategySum%20%3D%20%20%0D%0A%20%20let%20nSum%2C%20numactions%20%3D%20Array.sum%20strategySum%2C%20strategySum.Length%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20if%20%20nSum%20%3C%3D%200.%20then%20%0D%0A%20%20%20%20%20%20%20Array.create%20numactions%20(1.%2Ffloat%20numactions)%20%0D%0A%20%20else%20Array.map%20(fun%20x%20-%3E%20x%2FnSum)%20strategySum%0D%0A%20%20%20%0D%0A%0D%0Alet%20getAction%20(actions%3A_%5B%5D)%20strategy%20%3D%20actions.%5BdiscreteSample%20strategy%5D%0D%0A%0D%0A%0D%0Alet%20train1%20iters%20f%20actions%20actionDistr%20regretSum%20strategySum%20%3D%0D%0A%20%20%20%20for%20_%20in%200..iters%20-%201%20do%0D%0A%20%20%20%20%20%20%20%20let%20strategy%20%3D%20getStrategy%20strategySum%20regretSum%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20let%20otheraction%20%3D%20getAction%20actions%20actionDistr%0D%0A%20%20%20%20%20%20%20%20let%20heroaction%20%20%3D%20getAction%20actions%20strategy%0D%0A%0D%0A%20%20%20%20%20%20%20%20let%20heroutil%2C_%20%3D%20f%20(heroaction%2Cotheraction)%0D%0A%0D%0A%20%20%20%20%20%20%20%20Array.iteri%20(fun%20a%20action%20-%3E%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20altutil%2C%20_%20%3D%20f%20(action%2Cotheraction)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20regretSum.%5Ba%5D%20%3C-%20regretSum.%5Ba%5D%20%2B%20(altutil%20-%20heroutil))%20actions%0D%0A%20%20%20%20%20%0D%0Alet%20train%20iters%20f%20actions%20regretSum%20regretSum2%20strategySum%20strategySum2%20%3D%0D%0A%20%20%20%20for%20_%20in%200..iters%20-%201%20do%0D%0A%20%20%20%20%20%20%20%20let%20strategy%20%20%3D%20getStrategy%20strategySum%20regretSum%0D%0A%20%20%20%20%20%20%20%20let%20strategy2%20%3D%20getStrategy%20strategySum2%20regretSum2%0D%0A%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20let%20otheraction%20%3D%20getAction%20actions%20strategy2%0D%0A%20%20%20%20%20%20%20%20let%20heroaction%20%20%3D%20getAction%20actions%20strategy%0D%0A%0D%0A%20%20%20%20%20%20%20%20let%20heroutil%2Cotherutil%20%3D%20f%20(heroaction%2Cotheraction)%0D%0A%0D%0A%20%20%20%20%20%20%20%20Array.iteri%20(fun%20a%20action%20-%3E%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20altutil%20%2C%20_%20%3D%20f%20(action%2Cotheraction)%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20altutil2%2C%20_%20%3D%20f%20(action%2Cheroaction)%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20regretSum.%5Ba%5D%20%20%3C-%20regretSum.%5Ba%5D%20%20%2B%20(altutil%20-%20heroutil)%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20regretSum2.%5Ba%5D%20%3C-%20regretSum2.%5Ba%5D%20%2B%20(altutil2%20-%20otherutil))%20actions%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0Alet%20inline%20displayTable2%20title%20roundTableTo%20roundProbTo%20keepZeroes%20winner%20strat1%20strat2%20%3D%20%0D%0A%20%20%20%20let%20buildTable%20player%20%3D%0D%0A%20%20%20%20%20%20%20%20%5B%7Cfor%20(move%2Cp)%20in%20strat1%20do%0D%0A%20%20%20%20%20%20%20%20%20%20%20for%20(move2%2Cp2)%20in%20strat2%20-%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B%7Cstring%20move%3B%20string%20move2%3B%20string%20(round%20roundTableTo%20p)%20%3B%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20string%20(round%20roundTableTo%20p2)%3B%20string%20(round%20roundTableTo%20(p%20*%20p2))%3B%20%22%22%3B%20%22%22%7C%5D%20%2C%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(player%20(winner%20(move%2Cmove2))%20*%20(p%20*%20p2)%20%2C%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player%20(winner%20(move2%2Cmove))%20*%20(p%20*%20p2))%7C%5D%0D%0A%0D%0A%20%20%20%20let%20table%20%3D%20buildTable%20fst%20%20%20%20%0D%0A%20%20%20%20let%20tabledisp%20%3D%20%20%20%20Array.filter%20(fun%20(_%2C(p%2C_))%20%20%20-%3E%20keepZeroes%20%7C%7C%20round%20roundProbTo%20p%20%3C%3E%200.)%20table%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%3E%20Array.map%20%20%20%20(fun%20(row%2C(u%2Cu2))%20-%3E%20row.%5Brow.Length%20-%202%5D%20%3C-%20string%20(round%20roundTableTo%20u)%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20row.%5Brow.Length%20-%201%5D%20%3C-%20string%20(round%20roundTableTo%20u2)%3B%20row)%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20let%20astable%20%3D%20makeTable%20%22%5Cn%22%20%5B%7C%22Player%201%22%3B%22Player%202%22%3B%22Prob%201%22%3B%22Prob%202%22%3B%22Joint%20Prob%22%3B%22Player%201%20Util%22%3B%22Player%202%20Util%22%7C%5D%20title%20tabledisp%0D%0A%20%20%20%20%0D%0A%20%20%20%20printfn%20%22%5Cn%25s%5Cn%5CnPlayer1%3A%20%25A%20%7C%20Player2%20%3A%20%25A%22%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20astable%20(Array.sumBy%20(snd%20%3E%3E%20fst)%20(table)%20%7C%3E%20round%20roundProbTo)%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(Array.sumBy%20(snd%20%3E%3E%20snd)%20(table)%20%7C%3E%20round%20roundProbTo)%0D%0A%0D%0A%0D%0Alet%20inline%20displayTable%20title%20winner%20strat1%20strat2%20%3D%20displayTable2%20title%203%202%20false%20winner%20strat1%20strat2%20%0D%0A%0D%0A%0D%0Alet%20inline%20printStrategy2%20title%20n%20strat%20%3D%20%0D%0A%20%20%20%20%20%20let%20rows%20%3D%20Array.map%20(fun%20(move%2Cp)%20-%3E%20%5B%7Cstring%20move%3B%20string(round%20n%20p)%7C%5D)%20strat%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20let%20astable%20%3D%20makeTable%20%22%5Cn%22%20%5B%7C%22Move%22%3B%22Move%20Probability%22%7C%5D%20title%20rows%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20printfn%20%22%5Cn%25s%22%20astable%0D%0A%0D%0A%0D%0Alet%20inline%20printStrategy%20title%20strat%20%3D%20printStrategy2%20title%203%20strat%20%0D%0A%0D%0A%0D%0Alet%20simulatePlay%20dodisp%20rounds%20bet%20winner%20strat1%20strat2%20%3D%0D%0A%20%20%20%20let%20results%20%3D%20%0D%0A%20%20%20%20%20%20%20%20%5B%7Cfor%20_%20in%200..rounds%20-%201%20-%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20move1%20%3D%20strat1%20%7C%3E%20Array.unzip%20%7C%7C%3E%20getAction%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20move2%20%3D%20strat2%20%7C%3E%20Array.unzip%20%7C%7C%3E%20getAction%20%0D%0A%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20res1%2C%20res2%20%3D%20winner%20(move1%2C%20move2)%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20res1%20*%20bet%2C%20res2%20*%20bet%7C%5D%0D%0A%0D%0A%20%20%20%20let%20p1win%2Cp2win%20%3D%20Array.fold%20(pairop%20(%2B))%20(0.%2C0.)%20results%0D%0A%20%20%20%20if%20dodisp%20then%20printfn%20%22Player1%20wins%3A%20%25A%20%7C%20Player2%20wins%3A%20%25A%22%20p1win%20p2win%0D%0A%20%20%20%20p1win%2Cp2win%0D%0A%20%20%20%20%0D%0A%0D%0A%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%0D%0Alet%20reset%20(a%3A_%5B%5D)%20%3D%20for%20i%20in%200..a.Length%20-%201%20do%20a.%5Bi%5D%20%3C-%200.%20%20%20%0D%0A%0D%0Atype%20Moves2%20%3D%20R%20%7C%20P%20%7C%20S%20%7C%20T%0D%0A%0D%0A%2F%2FThe%20numbers%20control%20the%20utilities%20for%20the%20game.%20Ensure%20left%20and%20right%20sum%20to%200.%0D%0Alet%20winner2%20%3D%0D%0A%20%20%20%20function%20%0D%0A%20%20%20%20%20%20%7C%20(R%2CR)%20-%3E%20(%200.%2C0.%20)%0D%0A%20%20%20%20%20%20%7C%20(P%2CR)%20-%3E%20(%201.%2C-1.)%20%0D%0A%20%20%20%20%20%20%7C%20(S%2CR)%20-%3E%20(-1.%2C1.%20)%0D%0A%20%20%20%20%0D%0A%20%20%20%20%20%20%7C%20(T%2CR)%20-%3E%20(1.%2C-1.%20)%0D%0A%20%20%20%20%0D%0A%20%20%20%20%20%20%7C%20(R%2CP)%20-%3E%20(-1.%2C1.%20)%0D%0A%20%20%20%20%20%20%7C%20(P%2CP)%20-%3E%20(%200.%2C0.%20)%0D%0A%20%20%20%20%20%20%7C%20(S%2CP)%20-%3E%20(%201.%2C-1.)%0D%0A%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%7C%20(T%2CP)%20-%3E%20(%201.%2C-1.)%0D%0A%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%7C%20(R%2CS)%20-%3E%20(%201.%2C-1.)%0D%0A%20%20%20%20%20%20%7C%20(P%2CS)%20-%3E%20(-1.%2C1.%20)%0D%0A%20%20%20%20%20%20%7C%20(S%2CS)%20-%3E%20(%200.%2C0.%20)%20%0D%0A%20%20%20%20%0D%0A%20%20%20%20%20%20%7C%20(T%2CS)%20-%3E%20(%20-1.%2C1.)%20%0D%0A%20%20%20%20%20%0D%0A%20%20%20%20%20%20%7C%20(R%2CT)%20-%3E%20(-1.%2C1.%20)%0D%0A%20%20%20%20%20%20%7C%20(P%2CT)%20-%3E%20(-1.%2C1.%20)%0D%0A%20%20%20%20%20%20%7C%20(S%2CT)%20-%3E%20(1.%2C-1.%20)%0D%0A%20%20%20%20%20%20%7C%20(T%2CT)%20-%3E%20(0.%2C0.%20%20)%0D%0A%0D%0A%2F%2FThe%20numbers%20control%20the%20utilities%20for%20the%20game.%20Ensure%20left%20and%20right%20sum%20to%200.%0D%0Alet%20winner3%20%3D%0D%0A%20%20%20%20function%20%0D%0A%20%20%20%20%20%20%7C%20(R%2CR)%20-%3E%20(%200.%2C0.%20)%0D%0A%20%20%20%20%20%20%7C%20(P%2CR)%20-%3E%20(%201.%2C-1.)%20%0D%0A%20%20%20%20%20%20%7C%20(S%2CR)%20-%3E%20(-1.%2C1.%20)%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2FThis%20essentially%20flips%20a%20coin%20but%20can%20change%20the%20number%20to%20%3C%3D%201.%0D%0A%20%20%20%20%20%20%7C%20(T%2CR)%20-%3E%20if%20random.NextDouble()%20%3C%200.5%20then%20(1.%2C-1.%20)%20else%20(-1.%2C1.%20)%0D%0A%20%20%20%20%0D%0A%20%20%20%20%20%20%7C%20(R%2CP)%20-%3E%20(-1.%2C1.%20)%0D%0A%20%20%20%20%20%20%7C%20(P%2CP)%20-%3E%20(%200.%2C0.%20)%0D%0A%20%20%20%20%20%20%7C%20(S%2CP)%20-%3E%20(%201.%2C-1.)%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2Froll%20a%20die%20with%20sides%204%20or%20less%20as%20wins.%0D%0A%20%20%20%20%20%20%7C%20(T%2CP)%20-%3E%20if%20random.NextDouble()%20%3C%204.%2F6.%20then%20(1.%2C-1.%20)%20else%20(-1.%2C1.%20)%0D%0A%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%7C%20(R%2CS)%20-%3E%20(%201.%2C-1.)%0D%0A%20%20%20%20%20%20%7C%20(P%2CS)%20-%3E%20(-1.%2C1.%20)%0D%0A%20%20%20%20%20%20%7C%20(S%2CS)%20-%3E%20(%200.%2C0.%20)%20%0D%0A%20%20%20%20%0D%0A%20%20%20%20%20%20%7C%20(T%2CS)%20-%3E%20(-1.%2C1.)%0D%0A%20%20%20%20%20%0D%0A%20%20%20%20%20%20%7C%20(R%2CT)%20-%3E%20if%20random.NextDouble()%20%3C%200.5%20then%20(-1.%2C1.%20)%20else%20(1.%2C-1.%20)%0D%0A%20%20%20%20%20%20%7C%20(P%2CT)%20-%3E%20if%20random.NextDouble()%20%3C%204.%2F6.%20then%20(-1.%2C1.%20)%20else%20(1.%2C-1.%20)%0D%0A%20%20%20%20%20%20%7C%20(S%2CT)%20-%3E%20(1.%2C-1.)%0D%0A%20%20%20%20%20%20%7C%20(T%2CT)%20-%3E%20(0.%2C0.%20)%0D%0A%2F%2F---------------------------%0D%0A%0D%0Alet%20regretSumX%20%20%20%3D%20%5B%7C0.%3B0.%3B0.%3B0.%7C%5D%0D%0Alet%20strategySumX%20%3D%20%5B%7C0.%3B0.%3B0.%3B0.%7C%5D%0D%0A%0D%0Alet%20regretSum2X%20%20%20%3D%20%5B%7C0.%3B0.%3B0.%3B0.%7C%5D%0D%0Alet%20strategySum2X%20%3D%20%5B%7C0.%3B0.%3B0.%3B0.%7C%5D%0D%0A%20%20%20%20%0D%0Alet%20rpstStratDef%20%20%3D%20Array.zip%20%5B%7CR%3BP%3BS%3BT%7C%5D%20%5B%7C0.4%3B0.4%3B0.1%3B0.1%7C%5D%20%2F%2F%3C%3D%3D%20These%20numbers%20can%20be%20changed.%20Ensure%20sums%20to%201.%0D%0Alet%20rpstStratDef2%20%3D%20Array.zip%20%5B%7CR%3BP%3BS%3BT%7C%5D%20%5B%7C0.3%3B0.2%3B0.1%3B0.4%7C%5D%20%2F%2F%3C%3D%3D%20These%20numbers%20can%20be%20changed.%20Ensure%20sums%20to%201.%20%0D%0Alet%20purePaper%20%20%20%20%20%3D%20Array.zip%20%5B%7CR%3BP%3BS%3BT%7C%5D%20%5B%7C0.%3B1.%3B0.%3B0.%7C%5D%20%20%20%0D%0Alet%20pureRock%20%20%20%20%20%20%3D%20Array.zip%20%5B%7CR%3BP%3BS%3BT%7C%5D%20%5B%7C1.%3B0.%3B0.%3B0.%7C%5D%20%20%20%0D%0Alet%20pureTelephone%20%3D%20Array.zip%20%5B%7CR%3BP%3BS%3BT%7C%5D%20%5B%7C0.%3B0.%3B0.%3B1.%7C%5D%20%20%20%0D%0A%0D%0Alet%20winnerFunction%20%3D%20winner3%20%2F%2F%3C%3D%3D%20Change%20the%20name%20of%20this%20function%20to%20either%20*winner2*%20or%20*winner3*%20to%20control%20what%20is%20learnt%0D%0A%0D%0Atrain1%20200_000%20winnerFunction%20%5B%7CR%3BP%3BS%3BT%7C%5D%20(Array.map%20snd%20rpstStratDef)%20regretSumX%20strategySumX%20%0D%0A%0D%0Alet%20rpstStrat1%20%3D%20Array.zip%20%5B%7CR%3BP%3BS%3BT%7C%5D%20(getAvgStrategy%20strategySumX)%20%20%20%0D%0AprintStrategy%20%22Learned%20Strategy%22%20rpstStrat1%20%20%20%20%20%0D%0A%0D%0AdisplayTable%20%22Learned%20Strategy%20vs%20Fixed%20Adversary%22%20winnerFunction%20rpstStrat1%20rpstStratDef%20%2F%2Fnote%20that%20displayTable%20probabilities%20and%20expected%20values%20aren't%20quite%20correct%20for%20winner3%20%0D%0A%0D%0Alet%20avg%20%3D%20%5B%7Cfor%20_%20in%200..99%20-%3E%20simulatePlay%20false%2010%205.%20winnerFunction%20rpstStrat1%20rpstStratDef%7C%5D%20%7C%3E%20Array.averageBy%20fst%20%20%20%20%0D%0Aprintfn%20%22%5Cn~Strategy%20EV%20(10%20rounds%2C%20%245%2Fround)%5Cn%5B%F0%9F%93%B0%2C100%25%25%5D%20vs%20%5B%F0%9F%91%8A%2C40%25%25%20%3B%F0%9F%93%B0%2C%2040%25%25%3B%20%E2%9C%82%2C%2010%25%25%3B%20%20%F0%9F%93%A0%2C10%25%25%5D%20%3D%20%25A%22%20avg%0D%0A%0D%0A%0D%0A%2F%2F---------------------------%0D%0A%0D%0Areset%20regretSumX%3B%20reset%20strategySumX%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0D%0Atrain%20200_000%20winnerFunction%20%5B%7CR%3BP%3BS%3BT%7C%5D%20regretSumX%20regretSum2X%20strategySumX%20strategySum2X%0D%0A%0D%0Alet%20rpstStrat1b%2C%20rpstStrat2%20%3D%20%0D%0A%20%20%20%20Array.zip%20%5B%7CR%3BP%3BS%3BT%7C%5D%20(getAvgStrategy%20strategySumX)%20%2C%0D%0A%20%20%20%20Array.zip%20%5B%7CR%3BP%3BS%3BT%7C%5D%20(getAvgStrategy%20strategySum2X)%20%0D%0A%0D%0AprintStrategy%20%22Equil1%22%20rpstStrat1b%0D%0AprintStrategy%20%22Equil2%22%20rpstStrat2%0D%0A%0D%0AdisplayTable%20%22Equil%22%20winnerFunction%20rpstStrat1b%20rpstStrat2%0D%0A%0D%0AdisplayTable%20%22equil1%20vs%20adv%22%20winnerFunction%20rpstStrat1b%20rpstStratDef%20%0D%0AdisplayTable%20%22rock%20vs%20equil2%22%20%20winnerFunction%20pureRock%20rpstStrat2%20%0D%0A" />
        </div>
    </body>
</html>